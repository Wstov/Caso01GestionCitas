@model GestionDeCitasBLL.Dtos.CitaDto
@using GestionDeCitasDAL.Entidades

<div class="modal-header">
    <h5 class="modal-title">Cambiar estado de la cita #@Model.Id</h5>
    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
</div>

<div class="modal-body">
    <div class="mb-2">
        <label class="form-label">Nuevo estado</label>
        <select class="form-select" asp-for="Estado" asp-items="Html.GetEnumSelectList<EstadoCita>()"></select>
    </div>
</div>

<div class="modal-footer">
    <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
    <button class="btn btn-primary" id="btnCambiar">Cambiar</button>
</div>

<script>
    $('#btnCambiar').on('click', function () {
        $.post('/Citas/CambiarEstadoConfirm', { id: @Model.Id, estado: $('#Estado').val() })
            .done(msg => Swal.fire('Éxito', msg, 'success').then(() => location.reload()))
            .fail(xhr => Swal.fire('Error', xhr.responseText || 'No se pudo actualizar', 'error'));
    });
</script>
